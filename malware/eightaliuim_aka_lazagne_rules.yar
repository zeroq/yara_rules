
import "pe"

rule eightaliuim : malware python
{
    meta:
        author = "Jan Goebel"
        description = "Detect Eightaliuim Python Password Stealer"
        created = "2021-05-21"
        modified = "2021-05-21"
    strings:
        $s1 = ".gfids"
        $s2 = "bcryptography\\hazmat\\bindings\\"
        $s3 = "pyi-windows-manifest-filename"
    condition:
        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and
        filesize < 14MB and filesize > 13MB and
        pe.machine == pe.MACHINE_AMD64 and
        $s1 and $s2 and $s3
}

