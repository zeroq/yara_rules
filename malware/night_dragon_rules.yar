
import "hash"
import "pe"

rule Night_Dragon_RAT : DLL RAT
{
    meta:
        author = "Jan Goebel"
        description = "Detect NightDragon RAT"
        reference = "https://en.wikipedia.org/wiki/Night_Dragon_Operation"
        created = "2021-05-16"
        modified = "2021-05-16"
    strings:
        $x1 = "Server.dll" nocase
        $x2 = "ServiceMain" nocase
    condition:
        (pe.characteristics & pe.DLL) and // is a DLL file
        filesize < 20KB and  // less than 20KB in size
        (
            ($x1 and $x2) or
            hash.md5(0, filesize) == "2b61964d00abf542c2af3cc40362036b"
        )
}
